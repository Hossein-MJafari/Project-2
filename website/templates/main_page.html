{% extends 'base.html' %}
{% block style %}<link rel="stylesheet" href="{{ url_for('static', filename='css/main_page_style.css') }}">{% endblock style %}
{% block title %}Store{% endblock title %}


{% block menu %}
<div class="collapse navbar-collapse" id="navbarNavAltMarkup">
  <ul class="navbar-nav ms-auto">
    <li class="nav-item">
      <a class="nav-link" href="{{ url_for('views.shopping_cart') }}"
        >Shopping Cart
      </a>
    </li>
  </ul>
  <div class="navbar-nav">
    <a
      class="nav-link"
      aria-current="page"
      href="{{ url_for('views.add_product') }}"
      >Add Product</a
    >
  </div>
</div>
{% endblock menu %}

{% block content %}

		<div class="container">
			{% for item in items %}
			<div class="item-box" style="position: relative">
				<img src="{{ url_for('static', filename=item[4]) }}" />
				<h3>{{ item[1] }}</h3>
				<p>{{ item[2] }}â‚¬</p>
				<p>{{ item[6] }} IRR</p>
				<p>stock:{{ item[3] }}</p>
				<button>Add to cart</button>
				<button id="{{ item[0] }}" class="add-to-cart">
					Add to cart
				</button>
			</div>
			{% endfor %}
		</div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      $(document).ready(function () {
        $(".add-to-cart").click(function () {
          const itemId = $(this).attr("id");
          $.ajax({
            url: "/cart",
            method: "POST",
            data: {
              item_id: itemId,
            },
          }).done(function (response) {
            if (response.status === "success") {
              alert("Item added to cart.");
            } else {
              alert("Item is already in the cart.");
            }
          });
        });
      });
    </script>
{% endblock content %}
